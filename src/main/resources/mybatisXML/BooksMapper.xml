<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.sp001.mapper.BooksMapper">
    <resultMap id="BooksResultMap" type="com.sp001.pojo.Books">
        <id property="id" column="id"/>
        <result property="bookname" column="bookname"/>
        <result property="price" column="price"/>
        <result property="sellerId" column="sellerId"/>
        <result property="buyerId" column="buyerId"/>
        <result property="created_time" column="created_time"/>
    </resultMap>

    <select id="findAllBooks" resultMap="BooksResultMap">
        SELECT id, bookname, price, sellerId, buyerId, created
        FROM books
    </select>

    <select id="findByBookname" resultMap="BooksResultMap">
        SELECT id, bookname, price, sellerId, buyerId, created_time
        FROM books
        WHERE bookname LIKE CONCAT('%', #{keyword}, '%')
    </select>

    <insert id="insertBook" parameterType="com.sp001.pojo.Books">
        INSERT INTO books (bookname, price, sellerId, buyerId, created_time)
        VALUES (#{bookname}, #{price}, #{sellerId}, #{buyerId}, NOW())
    </insert>

    <update id="updateBook" parameterType="com.sp001.pojo.Books">
        UPDATE books SET bookname=#{bookname}, price=#{price}, sellerId=#{sellerId}, buyerId=#{buyerId}, created_time=#{created_time} WHERE id=#{id}
    </update>

    <delete id="deleteBook">
        DELETE FROM books WHERE id=#{id}
    </delete>

    <select id="getBookById" resultMap="BooksResultMap">
        SELECT id, bookname, price, sellerId, buyerId
        FROM books
        WHERE id = #{id} <!-- #{id}对应接口中@Param("id")的参数 -->
    </select>

    <select id="findBooksBySellerId" resultType="com.sp001.pojo.Books">
        SELECT * FROM books
        WHERE sellerId = #{sellerId}
        ORDER BY created_time DESC
    </select>
</mapper>